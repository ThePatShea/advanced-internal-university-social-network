<template name="bubblePageBackbone">

  <div id="form-loader" class="form-loader visible-{{isLoading}}">
    {{> gifLoaderToParent}}
  </div>
    
  {{#with getCurrentBubbleBackbone}}

    {{> bubbleCoverBackbone}}
    {{> bubbleSectionSelectorBackbone}}
    
    <div class="visible-{{isLoading}}">
      {{> gifLoaderToParent}}
    </div>

    <div class="bubble-page-content">

        {{#codeComment}}
          {{#if compressedUpdates id '1'}}
            <div class="bubble-list">
              <div class="bubble-list-heading">
                <h3 class="section-name pull-left">{{compressedUpdatesCount this.id}} updates</h3>

                <button class="std-btn-light pull-right clear-updates">clear all</button> 
                
                {{#if showMoreUpdates compressedUpdatesCount}}
                  <button class="std-btn-light pull-right more-updates">see all</button>
                {{/if}}
                
              </div>
              {{> updatesList}}
            </div>
          {{/if}}
        {{/codeComment}}
        {{#if showUpdates}}
        <div class="visible-{{testNumUpdates}}">
          <div class="bubble-list">
            <div class="bubble-list-heading">
              <h3 class="section-name pull-left">{{pluralize testNumUpdates 'update' ""}}</h3>
                  <button class="std-btn-light pull-right clear-updates">clear all</button> 
                </div>
                <div class="dashboard-updates">
              {{#each testGetUpdates}}
                {{>updateItem}}
              {{/each}}
              <button class="pull-left btn-tiny more-updates" style="margin: 15px 0 0 25px">+ see all</button>
            </div>
          </div>
        </div>
        {{/if}}
  
        <div class="bubble-list">
          {{#with postPropertiesBackboneEvent}}
            <div></div>
            {{> listHeading}}
            {{#each posts}}
              {{> listItemBB}}
            {{else}}
              <div class="post-item">
                <div class="v-middle">
                  <div class="v-inner">
                    No events yet. Schedule meetings and other members-only events here!
                  </div>
                </div>
              </div>
            {{/each}}
            <a class="visible" href="{{bubbleEventPageBackbonePath getCurrentBubbleBackbone.id}}">
              <button class="pull-left btn-tiny more-posts">+ view more events</button>
            </a>
          {{/with}}
        </div>

        <div class="bubble-list">
          {{#with postPropertiesBackboneDiscussion}}
            <div></div>
            {{> listHeading}}
            {{#each posts}}
              {{> listItemBB}}
            {{else}}
              <div class="post-item">
                <div class="v-middle">
                  <div class="v-inner">
                    No discussions? Start discussions for any topic here!
                  </div>
                </div>
              </div>
            {{/each}}
            <a class="visible" href="{{bubbleDiscussionPageBackbonePath getCurrentBubbleBackbone.id}}">
              <button class="pull-left btn-tiny more-posts">+ view more discussions</button>
            </a>
          {{/with}}
        </div>
  
        <div class="bubble-list">
          {{#with postPropertiesBackboneFile}}
            <div></div>
            {{> listHeading}}
            {{#each posts}}
              {{> listItemBB}}
            {{else}}
              <div class="post-item">
                <div class="v-middle">
                  <div class="v-inner">
                    No files? Add some here!
                  </div>
                </div>
              </div>
            {{/each}}
            <a class="visible" href="{{bubbleFilePageBackbonePath getCurrentBubbleBackbone.id}}">
              <button class="pull-left btn-tiny more-posts">+ view more files</button>
            </a>
          {{/with}}
        </div>
    </div>
  {{/with}}
</template>
